/* jQuery Form Plugin; v20131227 http://jquery.malsup.com/form/ - Copyright (c) 2013 M. Alsup; Dual licensed: MIT/GPL - https://github.com/malsup/form#copyright-and-license */
!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],a):a("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(a){"use strict";function d(b){var c=b.data;b.isDefaultPrevented()||(b.preventDefault(),a(b.target).ajaxSubmit(c))}function e(b){var c=b.target,d=a(c);if(!d.is("[type=submit],[type=image]")){var e=d.closest("[type=submit]");if(0===e.length)return;c=e[0]}var f=this;if(f.clk=c,"image"==c.type)if(void 0!==b.offsetX)f.clk_x=b.offsetX,f.clk_y=b.offsetY;else if("function"==typeof a.fn.offset){var g=d.offset();f.clk_x=b.pageX-g.left,f.clk_y=b.pageY-g.top}else f.clk_x=b.pageX-c.offsetLeft,f.clk_y=b.pageY-c.offsetTop;setTimeout(function(){f.clk=f.clk_x=f.clk_y=null},100)}function f(){if(a.fn.ajaxSubmit.debug){var b="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(b):window.opera&&window.opera.postError&&window.opera.postError(b)}}var b={};b.fileapi=void 0!==a("<input type='file'/>").get(0).files,b.formdata=void 0!==window.FormData;var c=!!a.fn.prop;a.fn.attr2=function(){if(!c)return this.attr.apply(this,arguments);var a=this.prop.apply(this,arguments);return a&&a.jquery||"string"==typeof a?a:this.attr.apply(this,arguments)},a.fn.ajaxSubmit=function(d){function B(b){var g,h,c=a.param(b,d.traditional).split("&"),e=c.length,f=[];for(g=0;e>g;g++)c[g]=c[g].replace(/\+/g," "),h=c[g].split("="),f.push([decodeURIComponent(h[0]),decodeURIComponent(h[1])]);return f}function C(b){for(var c=new FormData,f=0;f<b.length;f++)c.append(b[f].name,b[f].value);if(d.extraData){var g=B(d.extraData);for(f=0;f<g.length;f++)g[f]&&c.append(g[f][0],g[f][1])}d.data=null;var h=a.extend(!0,{},a.ajaxSettings,d,{contentType:!1,processData:!1,cache:!1,type:e||"POST"});d.uploadProgress&&(h.xhr=function(){var b=a.ajaxSettings.xhr();return b.upload&&b.upload.addEventListener("progress",function(a){var b=0,c=a.loaded||a.position,e=a.total;a.lengthComputable&&(b=Math.ceil(100*(c/e))),d.uploadProgress(a,c,e,b)},!1),b}),h.data=null;var i=h.beforeSend;return h.beforeSend=function(a,b){b.data=d.formData?d.formData:c,i&&i.call(this,a,b)},a.ajax(h)}function D(b){function y(a){var b=null;try{a.contentWindow&&(b=a.contentWindow.document)}catch(c){f("cannot get iframe.contentWindow document: "+c)}if(b)return b;try{b=a.contentDocument?a.contentDocument:a.document}catch(c){f("cannot get iframe.contentDocument: "+c),b=a.document}return b}function B(){function j(){try{var a=y(p).readyState;f("state = "+a),a&&"uninitialized"==a.toLowerCase()&&setTimeout(j,50)}catch(b){f("Server abort: ",b," (",b.name,")"),G(x),u&&clearTimeout(u),u=void 0}}var b=i.attr2("target"),c=i.attr2("action"),d="multipart/form-data",h=i.attr("enctype")||i.attr("encoding")||d;g.setAttribute("target",n),(!e||/post/i.test(e))&&g.setAttribute("method","POST"),c!=k.url&&g.setAttribute("action",k.url),k.skipEncodingOverride||e&&!/post/i.test(e)||i.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),k.timeout&&(u=setTimeout(function(){t=!0,G(w)},k.timeout));var l=[];try{if(k.extraData)for(var m in k.extraData)k.extraData.hasOwnProperty(m)&&(a.isPlainObject(k.extraData[m])&&k.extraData[m].hasOwnProperty("name")&&k.extraData[m].hasOwnProperty("value")?l.push(a('<input type="hidden" name="'+k.extraData[m].name+'">').val(k.extraData[m].value).appendTo(g)[0]):l.push(a('<input type="hidden" name="'+m+'">').val(k.extraData[m]).appendTo(g)[0]));k.iframeTarget||o.appendTo("body"),p.attachEvent?p.attachEvent("onload",G):p.addEventListener("load",G,!1),setTimeout(j,15);try{g.submit()}catch(q){var r=document.createElement("form").submit;r.apply(g)}}finally{g.setAttribute("action",c),g.setAttribute("enctype",h),b?g.setAttribute("target",b):i.removeAttr("target"),a(l).remove()}}function G(b){if(!q.aborted&&!F){if(D=y(p),D||(f("cannot access response document"),b=x),b===w&&q)return q.abort("timeout"),v.reject(q,"timeout"),void 0;if(b==x&&q)return q.abort("server abort"),v.reject(q,"error","server abort"),void 0;if(D&&D.location.href!=k.iframeSrc||t){p.detachEvent?p.detachEvent("onload",G):p.removeEventListener("load",G,!1);var d,c="success";try{if(t)throw"timeout";var e="xml"==k.dataType||D.XMLDocument||a.isXMLDoc(D);if(f("isXml="+e),!e&&window.opera&&(null===D.body||!D.body.innerHTML)&&--E)return f("requeing onLoad callback, DOM not available"),setTimeout(G,250),void 0;var g=D.body?D.body:D.documentElement;q.responseText=g?g.innerHTML:null,q.responseXML=D.XMLDocument?D.XMLDocument:D,e&&(k.dataType="xml"),q.getResponseHeader=function(a){var b={"content-type":k.dataType};return b[a.toLowerCase()]},g&&(q.status=Number(g.getAttribute("status"))||q.status,q.statusText=g.getAttribute("statusText")||q.statusText);var h=(k.dataType||"").toLowerCase(),i=/(json|script|text)/.test(h);if(i||k.textarea){var j=D.getElementsByTagName("textarea")[0];if(j)q.responseText=j.value,q.status=Number(j.getAttribute("status"))||q.status,q.statusText=j.getAttribute("statusText")||q.statusText;else if(i){var l=D.getElementsByTagName("pre")[0],n=D.getElementsByTagName("body")[0];l?q.responseText=l.textContent?l.textContent:l.innerText:n&&(q.responseText=n.textContent?n.textContent:n.innerText)}}else"xml"==h&&!q.responseXML&&q.responseText&&(q.responseXML=H(q.responseText));try{C=J(q,h,k)}catch(r){c="parsererror",q.error=d=r||c}}catch(r){f("error caught: ",r),c="error",q.error=d=r||c}q.aborted&&(f("upload aborted"),c=null),q.status&&(c=q.status>=200&&q.status<300||304===q.status?"success":"error"),"success"===c?(k.success&&k.success.call(k.context,C,"success",q),v.resolve(q.responseText,"success",q),m&&a.event.trigger("ajaxSuccess",[q,k])):c&&(void 0===d&&(d=q.statusText),k.error&&k.error.call(k.context,q,c,d),v.reject(q,"error",d),m&&a.event.trigger("ajaxError",[q,k,d])),m&&a.event.trigger("ajaxComplete",[q,k]),m&&!--a.active&&a.event.trigger("ajaxStop"),k.complete&&k.complete.call(k.context,q,c),F=!0,k.timeout&&clearTimeout(u),setTimeout(function(){k.iframeTarget?o.attr("src",k.iframeSrc):o.remove(),q.responseXML=null},100)}}}var h,j,k,m,n,o,p,q,r,s,t,u,g=i[0],v=a.Deferred();if(v.abort=function(a){q.abort(a)},b)for(j=0;j<l.length;j++)h=a(l[j]),c?h.prop("disabled",!1):h.removeAttr("disabled");if(k=a.extend(!0,{},a.ajaxSettings,d),k.context=k.context||k,n="jqFormIO"+(new Date).getTime(),k.iframeTarget?(o=a(k.iframeTarget),s=o.attr2("name"),s?n=s:o.attr2("name",n)):(o=a('<iframe name="'+n+'" src="'+k.iframeSrc+'" />'),o.css({position:"absolute",top:"-1000px",left:"-1000px"})),p=o[0],q={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(b){var c="timeout"===b?"timeout":"aborted";f("aborting upload... "+c),this.aborted=1;try{p.contentWindow.document.execCommand&&p.contentWindow.document.execCommand("Stop")}catch(d){}o.attr("src",k.iframeSrc),q.error=c,k.error&&k.error.call(k.context,q,c,b),m&&a.event.trigger("ajaxError",[q,k,c]),k.complete&&k.complete.call(k.context,q,c)}},m=k.global,m&&0===a.active++&&a.event.trigger("ajaxStart"),m&&a.event.trigger("ajaxSend",[q,k]),k.beforeSend&&k.beforeSend.call(k.context,q,k)===!1)return k.global&&a.active--,v.reject(),v;if(q.aborted)return v.reject(),v;r=g.clk,r&&(s=r.name,s&&!r.disabled&&(k.extraData=k.extraData||{},k.extraData[s]=r.value,"image"==r.type&&(k.extraData[s+".x"]=g.clk_x,k.extraData[s+".y"]=g.clk_y)));var w=1,x=2,z=a("meta[name=csrf-token]").attr("content"),A=a("meta[name=csrf-param]").attr("content");A&&z&&(k.extraData=k.extraData||{},k.extraData[A]=z),k.forceSync?B():setTimeout(B,10);var C,D,F,E=50,H=a.parseXML||function(a,b){return window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml"),b&&b.documentElement&&"parsererror"!=b.documentElement.nodeName?b:null},I=a.parseJSON||function(a){return window.eval("("+a+")")},J=function(b,c,d){var e=b.getResponseHeader("content-type")||"",f="xml"===c||!c&&e.indexOf("xml")>=0,g=f?b.responseXML:b.responseText;return f&&"parsererror"===g.documentElement.nodeName&&a.error&&a.error("parsererror"),d&&d.dataFilter&&(g=d.dataFilter(g,c)),"string"==typeof g&&("json"===c||!c&&e.indexOf("json")>=0?g=I(g):("script"===c||!c&&e.indexOf("javascript")>=0)&&a.globalEval(g)),g};return v}if(!this.length)return f("ajaxSubmit: skipping submit process - no element selected"),this;var e,g,h,i=this;"function"==typeof d?d={success:d}:void 0===d&&(d={}),e=d.type||this.attr2("method"),g=d.url||this.attr2("action"),h="string"==typeof g?a.trim(g):"",h=h||window.location.href||"",h&&(h=(h.match(/^([^#]+)/)||[])[1]),d=a.extend(!0,{url:h,success:a.ajaxSettings.success,type:e||a.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},d);var j={};if(this.trigger("form-pre-serialize",[this,d,j]),j.veto)return f("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(d.beforeSerialize&&d.beforeSerialize(this,d)===!1)return f("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var k=d.traditional;void 0===k&&(k=a.ajaxSettings.traditional);var m,l=[],n=this.formToArray(d.semantic,l);if(d.data&&(d.extraData=d.data,m=a.param(d.data,k)),d.beforeSubmit&&d.beforeSubmit(n,this,d)===!1)return f("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[n,this,d,j]),j.veto)return f("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var o=a.param(n,k);m&&(o=o?o+"&"+m:m),"GET"==d.type.toUpperCase()?(d.url+=(d.url.indexOf("?")>=0?"&":"?")+o,d.data=null):d.data=o;var p=[];if(d.resetForm&&p.push(function(){i.resetForm()}),d.clearForm&&p.push(function(){i.clearForm(d.includeHidden)}),!d.dataType&&d.target){var q=d.success||function(){};p.push(function(b){var c=d.replaceTarget?"replaceWith":"html";a(d.target)[c](b).each(q,arguments)})}else d.success&&p.push(d.success);if(d.success=function(a,b,c){for(var e=d.context||this,f=0,g=p.length;g>f;f++)p[f].apply(e,[a,b,c||i,i])},d.error){var r=d.error;d.error=function(a,b,c){var e=d.context||this;r.apply(e,[a,b,c,i])}}if(d.complete){var s=d.complete;d.complete=function(a,b){var c=d.context||this;s.apply(c,[a,b,i])}}var t=a("input[type=file]:enabled",this).filter(function(){return""!==a(this).val()}),u=t.length>0,v="multipart/form-data",w=i.attr("enctype")==v||i.attr("encoding")==v,x=b.fileapi&&b.formdata;f("fileAPI :"+x);var z,y=(u||w)&&!x;d.iframe!==!1&&(d.iframe||y)?d.closeKeepAlive?a.get(d.closeKeepAlive,function(){z=D(n)}):z=D(n):z=(u||w)&&x?C(n):a.ajax(d),i.removeData("jqxhr").data("jqxhr",z);for(var A=0;A<l.length;A++)l[A]=null;return this.trigger("form-submit-notify",[this,d]),this},a.fn.ajaxForm=function(b){if(b=b||{},b.delegation=b.delegation&&a.isFunction(a.fn.on),!b.delegation&&0===this.length){var c={s:this.selector,c:this.context};return!a.isReady&&c.s?(f("DOM not ready, queuing ajaxForm"),a(function(){a(c.s,c.c).ajaxForm(b)}),this):(f("terminating; zero elements found by selector"+(a.isReady?"":" (DOM not ready)")),this)}return b.delegation?(a(document).off("submit.form-plugin",this.selector,d).off("click.form-plugin",this.selector,e).on("submit.form-plugin",this.selector,b,d).on("click.form-plugin",this.selector,b,e),this):this.ajaxFormUnbind().bind("submit.form-plugin",b,d).bind("click.form-plugin",b,e)},a.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},a.fn.formToArray=function(c,d){var e=[];if(0===this.length)return e;var i,f=this[0],g=this.attr("id"),h=c?f.getElementsByTagName("*"):f.elements;if(h&&(h=a(h).get()),g&&(i=a(":input[form="+g+"]").get(),i.length&&(h=(h||[]).concat(i))),!h||!h.length)return e;var j,k,l,m,n,o,p;for(j=0,o=h.length;o>j;j++)if(n=h[j],l=n.name,l&&!n.disabled)if(c&&f.clk&&"image"==n.type)f.clk==n&&(e.push({name:l,value:a(n).val(),type:n.type}),e.push({name:l+".x",value:f.clk_x},{name:l+".y",value:f.clk_y}));else if(m=a.fieldValue(n,!0),m&&m.constructor==Array)for(d&&d.push(n),k=0,p=m.length;p>k;k++)e.push({name:l,value:m[k]});else if(b.fileapi&&"file"==n.type){d&&d.push(n);var q=n.files;if(q.length)for(k=0;k<q.length;k++)e.push({name:l,value:q[k],type:n.type});else e.push({name:l,value:"",type:n.type})}else null!==m&&"undefined"!=typeof m&&(d&&d.push(n),e.push({name:l,value:m,type:n.type,required:n.required}));if(!c&&f.clk){var r=a(f.clk),s=r[0];l=s.name,l&&!s.disabled&&"image"==s.type&&(e.push({name:l,value:r.val()}),e.push({name:l+".x",value:f.clk_x},{name:l+".y",value:f.clk_y}))}return e},a.fn.formSerialize=function(b){return a.param(this.formToArray(b))},a.fn.fieldSerialize=function(b){var c=[];return this.each(function(){var d=this.name;if(d){var e=a.fieldValue(this,b);if(e&&e.constructor==Array)for(var f=0,g=e.length;g>f;f++)c.push({name:d,value:e[f]});else null!==e&&"undefined"!=typeof e&&c.push({name:this.name,value:e})}}),a.param(c)},a.fn.fieldValue=function(b){for(var c=[],d=0,e=this.length;e>d;d++){var f=this[d],g=a.fieldValue(f,b);null===g||"undefined"==typeof g||g.constructor==Array&&!g.length||(g.constructor==Array?a.merge(c,g):c.push(g))}return c},a.fieldValue=function(b,c){var d=b.name,e=b.type,f=b.tagName.toLowerCase();if(void 0===c&&(c=!0),c&&(!d||b.disabled||"reset"==e||"button"==e||("checkbox"==e||"radio"==e)&&!b.checked||("submit"==e||"image"==e)&&b.form&&b.form.clk!=b||"select"==f&&-1==b.selectedIndex))return null;if("select"==f){var g=b.selectedIndex;if(0>g)return null;for(var h=[],i=b.options,j="select-one"==e,k=j?g+1:i.length,l=j?g:0;k>l;l++){var m=i[l];if(m.selected){var n=m.value;if(n||(n=m.attributes&&m.attributes.value&&!m.attributes.value.specified?m.text:m.value),j)return n;h.push(n)}}return h}return a(b).val()},a.fn.clearForm=function(b){return this.each(function(){a("input,select,textarea",this).clearFields(b)})},a.fn.clearFields=a.fn.clearInputs=function(b){var c=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var d=this.type,e=this.tagName.toLowerCase();c.test(d)||"textarea"==e?this.value="":"checkbox"==d||"radio"==d?this.checked=!1:"select"==e?this.selectedIndex=-1:"file"==d?/MSIE/.test(navigator.userAgent)?a(this).replaceWith(a(this).clone(!0)):a(this).val(""):b&&(b===!0&&/hidden/.test(d)||"string"==typeof b&&a(this).is(b))&&(this.value="")})},a.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},a.fn.enable=function(a){return void 0===a&&(a=!0),this.each(function(){this.disabled=!a})},a.fn.selected=function(b){return void 0===b&&(b=!0),this.each(function(){var c=this.type;if("checkbox"==c||"radio"==c)this.checked=b;else if("option"==this.tagName.toLowerCase()){var d=a(this).parent("select");b&&d[0]&&"select-one"==d[0].type&&d.find("option").selected(!1),this.selected=b}})},a.fn.ajaxSubmit.debug=!1});
/* jQuery Webcam; v20150126 https://github.com/thorin/jquery-webcam */
jQuery(function($){"use strict";var WebcamSwf=function(t,i){this.init(t,i)},WebcamGum=function(t,i){this.init(t,i)},WebcamBase={cameraEnabled:function(){return this.options.cameraEnabled.call(this)},cameraDisabled:function(){return this.options.cameraDisabled.call(this)},noCameraFound:function(){return this.options.noCameraFound.call(this)},isClientReady:function(){return this.options.isClientReady.call(this)},cameraReady:function(){return this.options.cameraReady.call(this)},error:function(t){return this.options.error.call(this,t)},debug:function(){return this.options.debug.call(this)},setUid:function(t){for(var i=t.attr("id");!i;){var e="webcam"+Math.floor(99999*Math.random());document.getElementById(e)||t.attr("id",i=e)}return i},getOptions:function(t){return $.extend({},$.fn.webcam.defaults,this.$element.data(),t)}};WebcamSwf.prototype=$.extend({},WebcamBase,{constructor:WebcamSwf,init:function(t,i){this.$element=$(t),this.id=this.setUid(this.$element),this.options=this.getOptions(i);var e="jQuery('#"+this.id+"').data('webcam')",a=$.param({callTarget:e,resolutionWidth:this.options.resolutionWidth,resolutionHeight:this.options.resolutionHeight,smoothing:this.options.videoSmoothing,deblocking:this.options.videoDeblocking,StageScaleMode:this.options.stageScaleMode,StageAlign:this.options.stageAlign}),o='<object id="'+this.id+'Object" type="application/x-shockwave-flash" data="'+this.options.swffile+'" width="'+this.options.previewWidth+'" height="'+this.options.previewHeight+'"><param name="movie" value="'+this.options.swffile+'" /><param name="FlashVars" value="'+a+'" /><param name="bgcolor" value="'+this.options.bgcolor+'" /><param name="allowScriptAccess" value="always" /><param name="wmode" value="opaque" /></object>';this.$cam=$(o),this.$element.append(this.$cam),this.cam=this.$cam[0]},cameraConnected:function(){this.isSwfReady=!0,this.cam=document.getElementById(this.id+"Object"),this.cameraReady()},save:function(){try{return this.cam.save()}catch(t){this.error(t)}},saveAndPost:function(t){try{return this.cam.saveAndPost(t)}catch(i){this.error(i)}},setCamera:function(t){try{return this.cam.setCamera(t)}catch(i){this.error(i)}},getCameraList:function(){try{return this.cam.getCameraList()}catch(t){this.error(t)}},getResolution:function(){try{return this.cam.getResolution()}catch(t){this.error(t)}},pause:function(){try{return this.cam.pause()}catch(t){this.error(t)}},play:function(){try{return this.cam.playCam()}catch(t){this.error(t)}}}),WebcamGum.prototype=$.extend({},WebcamBase,{constructor:WebcamGum,init:function(t,i){this.$element=$(t),this.id=this.setUid(this.$element),this.options=this.getOptions(i),this.$element.bind("webcamdestroy",$.noop),this.$wrapper=$("<div>",{css:{overflow:"hidden",maxWidth:"inherit",maxHeight:"inherit",width:this.options.previewWidth,height:this.options.previewHeight}}),this.$video=$('<video style="visibility:hidden" width="'+this.options.previewWidth+'" height="'+this.options.previewHeight+'" >'),this.$wrapper.append(this.$video),this.$element.append(this.$wrapper),this.$canvas=$("<canvas>"),this.video=this.$element.find("video")[0],navigator.getUserMedia({video:{mandatory:{minWidth:this.options.resolutionWidth,minHeight:this.options.resolutionHeight}},audio:!1},$.proxy(this.cameraConnected,this),$.proxy(this.cameraError,this))},cameraConnected:function(t){this.stream=t;var i=this.video;void 0!==i.mozSrcObject?i.mozSrcObject=t:i.src=window.URL&&window.URL.createObjectURL(t)||t,t.oninactive=function(){this.cameraDisabled()},i.play(),this.cameraReady(),this.$video.bind("loadeddata",$.proxy(this.checkVideo,this,10))},cameraError:function(t){("MANDATORY_UNSATISFIED_ERROR"==t||"MANDATORY_UNSATISFIED_ERROR"===t.name)&&this.noCameraFound(),this.error(t)},checkVideo:function(t){if(0>=t)return void this.error("Unable to play video stream. Is webcam working?");if(this.video.videoWidth<=0||this.video.videoHeight<=0)return void window.setTimeout($.proxy(this.checkVideo,this,t-1),500);var i=this.video.videoWidth/this.video.videoHeight;this.$video.css({visibility:"inherit",width:Math.max(this.options.previewWidth,this.options.previewHeight*i),height:Math.max(this.options.previewHeight,this.options.previewWidth/i),marginLeft:Math.min(0,-(this.options.previewHeight*i-this.options.previewWidth)/2),marginTop:Math.min(0,-(this.options.previewWidth/i-this.options.previewHeight)/2)});var e=this.options.previewWidth/this.options.previewHeight;this.$canvas.attr({width:Math.min(this.video.videoWidth,this.video.videoHeight*e),height:Math.min(this.video.videoHeight,this.video.videoWidth/e)}),this.cameraEnabled()},saveAndPost:function(options){this.captureToCanvas(),this.canvaToBlob(function(blob){var formData=new FormData;formData.append(options.filefield,blob,options.filename),$.each(options.data,function(t,i){formData.append(t,i)});var self=this;$.ajax({url:options.url,data:formData,type:"POST",dataType:"text",processData:!1,contentType:!1,success:function(data){eval(options.js_callback)(data)},error:function(t,i,e){self.error(e)}})},"image/jpeg",1)},save:function(){try{this.captureToCanvas();var t=this.$canvas[0].toDataURL("image/jpeg",1);return this.$canvas.remove(),t.substring(t.indexOf(",")+1)}catch(i){this.error(i)}},canvaToBlob:function(t,i,e){if(this.$canvas.toBlob)return this.$canvas(t,i,e);for(var a=this.$canvas[0].toDataURL("image/jpeg",1),o=a.match(/^data:([^;]+)(;base64)?,(.*)$/),n=atob(o[3]),s=new ArrayBuffer(n.length),r=new Uint8Array(s),h=0;h<r.length;h++)r[h]=n.charCodeAt(h);t(new Blob([r],{type:o[1]}))},captureToCanvas:function(){this.video.pause();var t=this.$canvas[0],i=t.getContext("2d"),e=t.width,a=t.height,o=(this.video.videoWidth-e)/2,n=(this.video.videoHeight-a)/2;i.drawImage(this.video,o,n,e,a,0,0,e,a),this.video.play()},setCamera:function(){return!0},getCameraList:function(){return[]},getResolution:function(){return[this.video.videoWidth,this.video.videoHeight]},pause:function(){this.video.pause()},play:function(){this.video.play()},destroy:function(){void 0!==this.video.mozSrcObject?this.video.mozSrcObject=null:this.video.src="",this.stream.stop()}}),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL;var Webcam;Webcam=navigator.getUserMedia?WebcamGum:WebcamSwf;var old=$.fn.webcam;$.fn.webcam=function(t){var i="string"==typeof t,e=Array.prototype.slice.call(arguments,1),a=this;return i?(this.each(function(){var i,o=$.data(this,"webcam");return o?"_"!==t.charAt(0)&&$.isFunction(o[t])?(i=o[t].apply(o,e),i!==o&&void 0!==i?(a=i&&i.jquery?a.pushStack(i.get()):i,!1):void 0):$.error("no such method '"+t+"' for webcam instance"):$.error("cannot call methods on webcam prior to initialization; attempted to call method '"+t+"'")}),a):this.each(function(){var i=$(this),e=i.data("webcam"),a="object"==typeof t&&t;e||i.data("webcam",e=new Webcam(this,a))})},$.fn.webcam.Constructor=Webcam,$.fn.webcam.defaults={previewWidth:320,previewHeight:240,resolutionWidth:320,resolutionHeight:240,videoDeblocking:0,videoSmoothing:0,bgcolor:"#000000",isCameraEnabled:!1,cameraEnabled:function(){},cameraDisabled:function(){},noCameraFound:function(){},isClientReady:function(){return!0},cameraReady:function(){},error:function(){},debug:function(){}},Webcam===WebcamSwf&&$.extend($.fn.webcam.defaults,{stageScaleMode:"noScale",stageAlign:"TL",swffile:"sAS3Cam.swf"}),$.fn.webcam.noConflict=function(){return $.fn.webcam=old,this},$.event.special.webcamdestroy={teardown:function(){$(this).data("webcam").destroy()}}});
/* Jcrop v0.9.12 http://deepliquid.com/content/Jcrop.html - https://github.com/tapmodo/Jcrop/blob/master/MIT-LICENSE.txt */
!function(a){a.Jcrop=function(b,c){function i(a){return Math.round(a)+"px"}function j(a){return d.baseClass+"-"+a}function k(){return a.fx.step.hasOwnProperty("backgroundColor")}function l(b){var c=a(b).offset();return[c.left,c.top]}function m(a){return[a.pageX-e[0],a.pageY-e[1]]}function n(b){"object"!=typeof b&&(b={}),d=a.extend(d,b),a.each(["onChange","onSelect","onRelease","onDblClick"],function(a,b){"function"!=typeof d[b]&&(d[b]=function(){})})}function o(a,b,c){if(e=l(D),bb.setCursor("move"===a?a:a+"-resize"),"move"===a)return bb.activateHandlers(q(b),v,c);var d=$.getFixed(),f=r(a),g=$.getCorner(r(f));$.setPressed($.getCorner(f)),$.setCurrent(g),bb.activateHandlers(p(a,d),v,c)}function p(a,b){return function(c){if(d.aspectRatio)switch(a){case"e":c[1]=b.y+1;break;case"w":c[1]=b.y+1;break;case"n":c[0]=b.x+1;break;case"s":c[0]=b.x+1}else switch(a){case"e":c[1]=b.y2;break;case"w":c[1]=b.y2;break;case"n":c[0]=b.x2;break;case"s":c[0]=b.x2}$.setCurrent(c),ab.update()}}function q(a){var b=a;return cb.watchKeys(),function(a){$.moveOffset([a[0]-b[0],a[1]-b[1]]),b=a,ab.update()}}function r(a){switch(a){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function s(a){return function(b){return d.disabled?!1:"move"!==a||d.allowMove?(e=l(D),W=!0,o(a,m(b)),b.stopPropagation(),b.preventDefault(),!1):!1}}function t(a,b,c){var d=a.width(),e=a.height();d>b&&b>0&&(d=b,e=b/a.width()*a.height()),e>c&&c>0&&(e=c,d=c/a.height()*a.width()),T=a.width()/d,U=a.height()/e,a.width(d).height(e)}function u(a){return{x:a.x*T,y:a.y*U,x2:a.x2*T,y2:a.y2*U,w:a.w*T,h:a.h*U}}function v(){var b=$.getFixed();b.w>d.minSelect[0]&&b.h>d.minSelect[1]?(ab.enableHandles(),ab.done()):ab.release(),bb.setCursor(d.allowSelect?"crosshair":"default")}function w(a){if(d.disabled)return!1;if(!d.allowSelect)return!1;W=!0,e=l(D),ab.disableHandles(),bb.setCursor("crosshair");var b=m(a);return $.setPressed(b),ab.update(),bb.activateHandlers(x,v,"touch"===a.type.substring(0,5)),cb.watchKeys(),a.stopPropagation(),a.preventDefault(),!1}function x(a){$.setCurrent(a),ab.update()}function y(){var b=a("<div></div>").addClass(j("tracker"));return g&&b.css({opacity:0,backgroundColor:"white"}),b}function db(a){G.removeClass().addClass(j("holder")).addClass(a)}function eb(a,b){function t(){window.setTimeout(u,l)}var c=a[0]/T,e=a[1]/U,f=a[2]/T,g=a[3]/U;if(!X){var h=$.flipCoords(c,e,f,g),i=$.getFixed(),j=[i.x,i.y,i.x2,i.y2],k=j,l=d.animationDelay,m=h[0]-j[0],n=h[1]-j[1],o=h[2]-j[2],p=h[3]-j[3],q=0,r=d.swingSpeed;c=k[0],e=k[1],f=k[2],g=k[3],ab.animMode(!0);var u=function(){return function(){q+=(100-q)/r,k[0]=Math.round(c+q/100*m),k[1]=Math.round(e+q/100*n),k[2]=Math.round(f+q/100*o),k[3]=Math.round(g+q/100*p),q>=99.8&&(q=100),100>q?(gb(k),t()):(ab.done(),ab.animMode(!1),"function"==typeof b&&b.call(rb))}}();t()}}function fb(a){gb([a[0]/T,a[1]/U,a[2]/T,a[3]/U]),d.onSelect.call(rb,u($.getFixed())),ab.enableHandles()}function gb(a){$.setPressed([a[0],a[1]]),$.setCurrent([a[2],a[3]]),ab.update()}function hb(){return u($.getFixed())}function ib(){return $.getFixed()}function jb(a){n(a),qb()}function kb(){d.disabled=!0,ab.disableHandles(),ab.setCursor("default"),bb.setCursor("default")}function lb(){d.disabled=!1,qb()}function mb(){ab.done(),bb.activateHandlers(null,null)}function nb(){G.remove(),A.show(),A.css("visibility","visible"),a(b).removeData("Jcrop")}function ob(a,b){ab.release(),kb();var c=new Image;c.onload=function(){var e=c.width,f=c.height,g=d.boxWidth,h=d.boxHeight;D.width(e).height(f),D.attr("src",a),H.attr("src",a),t(D,g,h),E=D.width(),F=D.height(),H.width(E).height(F),M.width(E+2*L).height(F+2*L),G.width(E).height(F),_.resize(E,F),lb(),"function"==typeof b&&b.call(rb)},c.src=a}function pb(a,b,c){var e=b||d.bgColor;d.bgFade&&k()&&d.fadeTime&&!c?a.animate({backgroundColor:e},{queue:!1,duration:d.fadeTime}):a.css("backgroundColor",e)}function qb(a){d.allowResize?a?ab.enableOnly():ab.enableHandles():ab.disableHandles(),bb.setCursor(d.allowSelect?"crosshair":"default"),ab.setCursor(d.allowMove?"move":"default"),d.hasOwnProperty("trueSize")&&(T=d.trueSize[0]/E,U=d.trueSize[1]/F),d.hasOwnProperty("setSelect")&&(fb(d.setSelect),ab.done(),delete d.setSelect),_.refresh(),d.bgColor!=N&&(pb(d.shade?_.getShades():G,d.shade?d.shadeColor||d.bgColor:d.bgColor),N=d.bgColor),O!=d.bgOpacity&&(O=d.bgOpacity,d.shade?_.refresh():ab.setBgOpacity(O)),P=d.maxSize[0]||0,Q=d.maxSize[1]||0,R=d.minSize[0]||0,S=d.minSize[1]||0,d.hasOwnProperty("outerImage")&&(D.attr("src",d.outerImage),delete d.outerImage),ab.refresh()}var e,d=a.extend({},a.Jcrop.defaults),f=navigator.userAgent.toLowerCase(),g=/msie/.test(f),h=/msie [1-6]\./.test(f);"object"!=typeof b&&(b=a(b)[0]),"object"!=typeof c&&(c={}),n(c);var z={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},A=a(b),B=!0;if("IMG"==b.tagName){if(0!=A[0].width&&0!=A[0].height)A.width(A[0].width),A.height(A[0].height);else{var C=new Image;C.src=A[0].src,A.width(C.width),A.height(C.height)}var D=A.clone().removeAttr("id").css(z).show();D.width(A.width()),D.height(A.height()),A.after(D).hide()}else D=A.css(z).show(),B=!1,null===d.shade&&(d.shade=!0);t(D,d.boxWidth,d.boxHeight);var E=D.width(),F=D.height(),G=a("<div />").width(E).height(F).addClass(j("holder")).css({position:"relative",backgroundColor:d.bgColor}).insertAfter(A).append(D);d.addClass&&G.addClass(d.addClass);var H=a("<div />"),I=a("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),J=a("<div />").width("100%").height("100%").css("zIndex",320),K=a("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var a=$.getFixed();d.onDblClick.call(rb,a)}).insertBefore(D).append(I,J);B&&(H=a("<img />").attr("src",D.attr("src")).css(z).width(E).height(F),I.append(H)),h&&K.css({overflowY:"hidden"});var P,Q,R,S,T,U,W,X,Y,L=d.boundary,M=y().width(E+2*L).height(F+2*L).css({position:"absolute",top:i(-L),left:i(-L),zIndex:290}).mousedown(w),N=d.bgColor,O=d.bgOpacity;e=l(D);var Z=function(){function a(){var d,a={},b=["touchstart","touchmove","touchend"],c=document.createElement("div");try{for(d=0;d<b.length;d++){var e=b[d];e="on"+e;var f=e in c;f||(c.setAttribute(e,"return;"),f="function"==typeof c[e]),a[b[d]]=f}return a.touchstart&&a.touchend&&a.touchmove}catch(g){return!1}}function b(){return d.touchSupport===!0||d.touchSupport===!1?d.touchSupport:a()}return{createDragger:function(a){return function(b){return d.disabled?!1:"move"!==a||d.allowMove?(e=l(D),W=!0,o(a,m(Z.cfilter(b)),!0),b.stopPropagation(),b.preventDefault(),!1):!1}},newSelection:function(a){return w(Z.cfilter(a))},cfilter:function(a){return a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY,a},isSupported:a,support:b()}}(),$=function(){function h(d){d=n(d),c=a=d[0],e=b=d[1]}function i(a){a=n(a),f=a[0]-c,g=a[1]-e,c=a[0],e=a[1]}function j(){return[f,g]}function k(d){var f=d[0],g=d[1];0>a+f&&(f-=f+a),0>b+g&&(g-=g+b),e+g>F&&(g+=F-(e+g)),c+f>E&&(f+=E-(c+f)),a+=f,c+=f,b+=g,e+=g}function l(a){var b=m();switch(a){case"ne":return[b.x2,b.y];case"nw":return[b.x,b.y];case"se":return[b.x2,b.y2];case"sw":return[b.x,b.y2]}}function m(){if(!d.aspectRatio)return p();var r,s,t,u,f=d.aspectRatio,g=d.minSize[0]/T,h=d.maxSize[0]/T,i=d.maxSize[1]/U,j=c-a,k=e-b,l=Math.abs(j),m=Math.abs(k),n=l/m;return 0===h&&(h=10*E),0===i&&(i=10*F),f>n?(s=e,t=m*f,r=0>j?a-t:t+a,0>r?(r=0,u=Math.abs((r-a)/f),s=0>k?b-u:u+b):r>E&&(r=E,u=Math.abs((r-a)/f),s=0>k?b-u:u+b)):(r=c,u=l/f,s=0>k?b-u:b+u,0>s?(s=0,t=Math.abs((s-b)*f),r=0>j?a-t:t+a):s>F&&(s=F,t=Math.abs(s-b)*f,r=0>j?a-t:t+a)),r>a?(g>r-a?r=a+g:r-a>h&&(r=a+h),s=s>b?b+(r-a)/f:b-(r-a)/f):a>r&&(g>a-r?r=a-g:a-r>h&&(r=a-h),s=s>b?b+(a-r)/f:b-(a-r)/f),0>r?(a-=r,r=0):r>E&&(a-=r-E,r=E),0>s?(b-=s,s=0):s>F&&(b-=s-F,s=F),q(o(a,b,r,s))}function n(a){return a[0]<0&&(a[0]=0),a[1]<0&&(a[1]=0),a[0]>E&&(a[0]=E),a[1]>F&&(a[1]=F),[Math.round(a[0]),Math.round(a[1])]}function o(a,b,c,d){var e=a,f=c,g=b,h=d;return a>c&&(e=c,f=a),b>d&&(g=d,h=b),[e,g,f,h]}function p(){var g,d=c-a,f=e-b;return P&&Math.abs(d)>P&&(c=d>0?a+P:a-P),Q&&Math.abs(f)>Q&&(e=f>0?b+Q:b-Q),S/U&&Math.abs(f)<S/U&&(e=f>0?b+S/U:b-S/U),R/T&&Math.abs(d)<R/T&&(c=d>0?a+R/T:a-R/T),0>a&&(c-=a,a-=a),0>b&&(e-=b,b-=b),0>c&&(a-=c,c-=c),0>e&&(b-=e,e-=e),c>E&&(g=c-E,a-=g,c-=g),e>F&&(g=e-F,b-=g,e-=g),a>E&&(g=a-F,e-=g,b-=g),b>F&&(g=b-F,e-=g,b-=g),q(o(a,b,c,e))}function q(a){return{x:a[0],y:a[1],x2:a[2],y2:a[3],w:a[2]-a[0],h:a[3]-a[1]}}var f,g,a=0,b=0,c=0,e=0;return{flipCoords:o,setPressed:h,setCurrent:i,getOffset:j,moveOffset:k,getCorner:l,getFixed:m}}(),_=function(){function f(a,b){e.left.css({height:i(b)}),e.right.css({height:i(b)})}function g(){return h($.getFixed())}function h(a){e.top.css({left:i(a.x),width:i(a.w),height:i(a.y)}),e.bottom.css({top:i(a.y2),left:i(a.x),width:i(a.w),height:i(F-a.y2)}),e.right.css({left:i(a.x2),width:i(E-a.x2)}),e.left.css({width:i(a.x)})}function j(){return a("<div />").css({position:"absolute",backgroundColor:d.shadeColor||d.bgColor}).appendTo(c)}function k(){b||(b=!0,c.insertBefore(D),g(),ab.setBgOpacity(1,0,1),H.hide(),l(d.shadeColor||d.bgColor,1),ab.isAwake()?n(d.bgOpacity,1):n(1,1))}function l(a,b){pb(p(),a,b)}function m(){b&&(c.remove(),H.show(),b=!1,ab.isAwake()?ab.setBgOpacity(d.bgOpacity,1,1):(ab.setBgOpacity(1,1,1),ab.disableHandles()),pb(G,0,1))}function n(a,e){b&&(d.bgFade&&!e?c.animate({opacity:1-a},{queue:!1,duration:d.fadeTime}):c.css({opacity:1-a}))}function o(){d.shade?k():m(),ab.isAwake()&&n(d.bgOpacity)}function p(){return c.children()}var b=!1,c=a("<div />").css({position:"absolute",zIndex:240,opacity:0}),e={top:j(),left:j().height(F),right:j().height(F),bottom:j()};return{update:g,updateRaw:h,getShades:p,setBgColor:l,enable:k,disable:m,resize:f,refresh:o,opacity:n}}(),ab=function(){function k(b){var c=a("<div />").css({position:"absolute",opacity:d.borderOpacity}).addClass(j(b));return I.append(c),c}function l(b,c){var d=a("<div />").mousedown(s(b)).css({cursor:b+"-resize",position:"absolute",zIndex:c}).addClass("ord-"+b);return Z.support&&d.bind("touchstart.jcrop",Z.createDragger(b)),J.append(d),d}function m(a){var b=d.handleSize,e=l(a,c++).css({opacity:d.handleOpacity}).addClass(j("handle"));return b&&e.width(b).height(b),e}function n(a){return l(a,c++).addClass("jcrop-dragbar")}function o(a){var b;for(b=0;b<a.length;b++)g[a[b]]=n(a[b])}function p(a){var b,c;for(c=0;c<a.length;c++){switch(a[c]){case"n":b="hline";break;case"s":b="hline bottom";break;case"e":b="vline right";break;case"w":b="vline"}e[a[c]]=k(b)}}function q(a){var b;for(b=0;b<a.length;b++)f[a[b]]=m(a[b])}function r(a,b){d.shade||H.css({top:i(-b),left:i(-a)}),K.css({top:i(b),left:i(a)})}function t(a,b){K.width(Math.round(a)).height(Math.round(b))}function v(){var a=$.getFixed();$.setPressed([a.x,a.y]),$.setCurrent([a.x2,a.y2]),w()}function w(a){return b?x(a):void 0}function x(a){var c=$.getFixed();t(c.w,c.h),r(c.x,c.y),d.shade&&_.updateRaw(c),b||A(),a?d.onSelect.call(rb,u(c)):d.onChange.call(rb,u(c))}function z(a,c,e){(b||c)&&(d.bgFade&&!e?D.animate({opacity:a},{queue:!1,duration:d.fadeTime}):D.css("opacity",a))}function A(){K.show(),d.shade?_.opacity(O):z(O,!0),b=!0}function B(){F(),K.hide(),d.shade?_.opacity(1):z(1),b=!1,d.onRelease.call(rb)}function C(){h&&J.show()}function E(){return h=!0,d.allowResize?(J.show(),!0):void 0}function F(){h=!1,J.hide()}function G(a){a?(X=!0,F()):(X=!1,E())}function L(){G(!1),v()}var b,c=370,e={},f={},g={},h=!1;d.dragEdges&&a.isArray(d.createDragbars)&&o(d.createDragbars),a.isArray(d.createHandles)&&q(d.createHandles),d.drawBorders&&a.isArray(d.createBorders)&&p(d.createBorders),a(document).bind("touchstart.jcrop-ios",function(b){a(b.currentTarget).hasClass("jcrop-tracker")&&b.stopPropagation()});var M=y().mousedown(s("move")).css({cursor:"move",position:"absolute",zIndex:360});return Z.support&&M.bind("touchstart.jcrop",Z.createDragger("move")),I.append(M),F(),{updateVisible:w,update:x,release:B,refresh:v,isAwake:function(){return b},setCursor:function(a){M.css("cursor",a)},enableHandles:E,enableOnly:function(){h=!0},showHandles:C,disableHandles:F,animMode:G,setBgOpacity:z,done:L}}(),bb=function(){function f(b){M.css({zIndex:450}),b?a(document).bind("touchmove.jcrop",k).bind("touchend.jcrop",l):e&&a(document).bind("mousemove.jcrop",h).bind("mouseup.jcrop",i)}function g(){M.css({zIndex:290}),a(document).unbind(".jcrop")}function h(a){return b(m(a)),!1}function i(a){return a.preventDefault(),a.stopPropagation(),W&&(W=!1,c(m(a)),ab.isAwake()&&d.onSelect.call(rb,u($.getFixed())),g(),b=function(){},c=function(){}),!1}function j(a,d,e){return W=!0,b=a,c=d,f(e),!1}function k(a){return b(m(Z.cfilter(a))),!1}function l(a){return i(Z.cfilter(a))}function n(a){M.css("cursor",a)}var b=function(){},c=function(){},e=d.trackDocument;return e||M.mousemove(h).mouseup(i).mouseout(i),D.before(M),{activateHandlers:j,setCursor:n}}(),cb=function(){function e(){d.keySupport&&(b.show(),b.focus())}function f(){b.hide()}function g(a,b,c){d.allowMove&&($.moveOffset([b,c]),ab.updateVisible(!0)),a.preventDefault(),a.stopPropagation()}function i(a){if(a.ctrlKey||a.metaKey)return!0;Y=a.shiftKey?!0:!1;var b=Y?10:1;switch(a.keyCode){case 37:g(a,-b,0);break;case 39:g(a,b,0);break;case 38:g(a,0,-b);break;case 40:g(a,0,b);break;case 27:d.allowSelect&&ab.release();break;case 9:return!0}return!1}var b=a('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),c=a("<div />").css({position:"absolute",overflow:"hidden"}).append(b);return d.keySupport&&(b.keydown(i).blur(f),h||!d.fixedSupport?(b.css({position:"absolute",left:"-20px"}),c.append(b).insertBefore(D)):b.insertBefore(D)),{watchKeys:e}}();Z.support&&M.bind("touchstart.jcrop",Z.newSelection),J.hide(),qb(!0);var rb={setImage:ob,animateTo:eb,setSelect:fb,setOptions:jb,tellSelect:hb,tellScaled:ib,setClass:db,disable:kb,enable:lb,cancel:mb,release:ab.release,destroy:nb,focus:cb.watchKeys,getBounds:function(){return[E*T,F*U]},getWidgetSize:function(){return[E,F]},getScaleFactor:function(){return[T,U]},getOptions:function(){return d},ui:{holder:G,selection:K}};return g&&G.bind("selectstart",function(){return!1}),A.data("Jcrop",rb),rb},a.fn.Jcrop=function(b,c){var d;return this.each(function(){if(a(this).data("Jcrop")){if("api"===b)return a(this).data("Jcrop");a(this).data("Jcrop").setOptions(b)}else"IMG"==this.tagName?a.Jcrop.Loader(this,function(){a(this).css({display:"block",visibility:"hidden"}),d=a.Jcrop(this,b),a.isFunction(c)&&c.call(d)}):(a(this).css({display:"block",visibility:"hidden"}),d=a.Jcrop(this,b),a.isFunction(c)&&c.call(d))}),this},a.Jcrop.Loader=function(b,c,d){function g(){f.complete?(e.unbind(".jcloader"),a.isFunction(c)&&c.call(f)):window.setTimeout(g,50)}var e=a(b),f=e[0];e.bind("load.jcloader",g).bind("error.jcloader",function(){e.unbind(".jcloader"),a.isFunction(d)&&d.call(f)}),f.complete&&a.isFunction(c)&&(e.unbind(".jcloader"),c.call(f))},a.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}}(jQuery);
/* jquery.avatars.js; v20140202 https://github.com/thorin/redmine_local_avatars - license: GPL v2 */
jQuery(function(a){"use strict";a.widget("avatars.cropper",{options:{previewContainer:"#preview-box",cropX:"crop_x",cropY:"crop_y",cropW:"crop_w",cropH:"crop_h",$previewOverflow:null,$previewElem:null,$cropboxElem:null,$cropboxContainer:null},_create:function(){this.options,this.$cropboxContainer=this.element,this.$previewContainer=a(this.options.previewContainer),this.previewWidth=this.$previewContainer.width(),this.previewHeight=this.$previewContainer.height()},start:function(b){var d=(this.options,this);a("<img>",{src:b,load:function(){d.imgWidth=this.width,d.imgHeight=this.height,d._initElements(b),d.$cropboxElem.load(function(){d.editWidth=d.$cropboxElem.width(),d.editHeight=d.$cropboxElem.height(),d._initJcrop()}),this.remove()}})},stop:function(){a(this.$cropboxContainer).contents().remove(),this.$previewOverflow.remove(),this.$previewContainer.find("img").show()},_initJcrop:function(){var b=this.previewWidth/this.previewHeight,c=Math.min(this.editWidth,this.editHeight*b),d=Math.min(this.editHeight,this.editWidth/b),e=Math.max(0,(this.editWidth-c)/2);this.$cropboxElem.Jcrop({onChange:a.proxy(this._updateCrop,this),onSelect:a.proxy(this._updateCrop,this),setSelect:[e,0,c,d],aspectRatio:b})},_initElements:function(b){this.$previewContainer.find("img").hide(),this.$previewOverflow=a("<div>",{css:{overflow:"hidden",width:"100%",height:"100%"}}),this.$previewElem=a("<img>",{src:b,css:{maxWidth:"inherit",maxHeight:"inherit",minWidth:"inherit",minHeight:"inherit"}}),this.$previewElem.appendTo(this.$previewOverflow),this.$previewOverflow.appendTo(this.$previewContainer),this.$cropboxElem=a("<img>",{"class":"cropbox",src:b}),this.$cropboxElem.appendTo(this.$cropboxContainer);var c=this;a.each(["cropX","cropY","cropW","cropH"],function(b,d){c["$"+d+"Elem"]=a("<input>",{name:c.options[d],type:"hidden"}),c["$"+d+"Elem"].appendTo(c.$cropboxContainer)})},_updateCrop:function(a){var b=this.editWidth*this.previewWidth/a.w,c=this.editHeight*this.previewHeight/a.h,d=a.x*this.previewWidth/a.w,e=a.y*this.previewHeight/a.h;this.$previewElem.css({width:Math.round(b)+"px",height:Math.round(c)+"px",marginLeft:"-"+Math.round(d)+"px",marginTop:"-"+Math.round(e)+"px"});var f=this.imgWidth/this.editWidth,g=this.imgHeight/this.editHeight;this.$cropXElem.val(Math.round(a.x*f)),this.$cropYElem.val(Math.round(a.y*g)),this.$cropWElem.val(Math.round(a.w*f)),this.$cropHElem.val(Math.round(a.h*g))},_destroy:function(){this.stop()}}),a.widget("avatars.photographer",{options:{previewWidth:null,previewHeight:null,resolutionWidth:null,resolutionHeight:null,swffile:"sAS3Cam.swf",captureButton:"#capture-webcam",startButton:"#start-webcam",stopButton:"#stop-webcam",camerasSelect:"#capture-cameras select",filename:null,filefield:null,postUrl:"#",postData:{},stageScaleMode:"noScale",stageAlign:"TL"},_create:function(){this.element.attr("id","photographer_"+this._random()),this.$webcamContainer=this.element,this.$startButton=a(this.options.startButton),this.$stopButton=a(this.options.stopButton),this.$captureButton=a(this.options.captureButton),this.$camerasSelect=a(this.options.camerasSelect),a.extend(this.options,{filename:this.options.filename||this._random()+".jpg",previewWidth:this.options.previewWidth||this.$webcamContainer.width(),previewHeight:this.options.previewHeight||this.$webcamContainer.height(),resolutionWidth:this.options.resolutionWidth||this.$webcamContainer.width(),resolutionHeight:this.options.resolutionHeight||this.$webcamContainer.height()});var b=this;this.$stopButton.click(function(a){a.preventDefault(),b.stop()}),this.$startButton.click(function(a){a.preventDefault(),b.start()})},disable:function(){this.$startButton.prop("disabled",!0)},enable:function(){this.$startButton.prop("disabled",!1)},start:function(){var c=(this.options,this);this.$startButton.prop("disabled",!0),c._trigger("beforestart",null),a("<div>").appendTo(this.$webcamContainer).webcam(a.extend({},this.options,{noCameraFound:function(){c._error("Web camera is not available")},error:function(a){c._error("Internal camera plugin error: "+(a?a.name||a:a))},cameraDisabled:function(){c._error("Please allow access to your camera")},cameraEnabled:function(){c._cameraEnabled(this)}}))},stop:function(){this.options,this._trigger("beforestop"),this.$webcamContainer.children().remove(),this.$captureButton.prop("disabled",!0).off("click"),this.$stopButton.hide().off("click"),this.$startButton.prop("disabled",!1).show(),this.$camerasSelect.parent().hide(),this.$camerasSelect.children().remove(),this.isCameraEnabled=!1},_cameraEnabled:function(a){var b=this;this.isCameraEnabled||(this.isCameraEnabled=!0,this.cameraApi=a,setTimeout(function(){b.$startButton.hide(),b.$stopButton.show(),b._showCamerasSelect(),b.cameraApi.setCamera("0"),b._trigger("afterstart",null,{api:b.cameraApi,cameras:b.cameraApi.getCameraList()}),b.$captureButton.prop("disabled",!1)},750),this.$captureButton.click(function(a){a.preventDefault();var c=b.element.attr("id");b._trigger("beforeupload",null,{}),b.cameraApi.saveAndPost({url:b.options.postUrl,filename:b.options.filename,filefield:b.options.filefield,data:b.options.postData,js_callback:"(function (d) {jQuery('#"+c+"').photographer('postCallback', d);})"})}))},_showCamerasSelect:function(){var b=this,c=this.cameraApi.getCameraList();if(!(c.length<=1)){this.$camerasSelect.parent().show();for(var d=0;d<c.length;d++)a("<option>",{val:d,text:c[d]}).appendTo(this.$camerasSelect);this.$camerasSelect.change(function(){b.cameraApi.setCamera(a(this).val())||b._error("Unable to select camera")})}},_error:function(a){this._trigger("error",null,{message:a})},postCallback:function(a){this.stop(),this._trigger("afterupload",null,{text:a})},_destroy:function(){this.stop()},_random:function(){return Math.floor(99999*Math.random())}}),a.widget("avatars.uploader",{options:{attachmentId:1,attachmentsContainer:"#attachments_fields",fileFieldContainer:".add_attachment"},_create:function(){var b=this;this.element.attr("id","uploader_"+this._random()),this.element.on("change","input[type=file]",function(){b.addInputFile(this)}),this.$fileFieldContainer=a(this.options.fileFieldContainer),this.$attachmentsContainer=a(this.options.attachmentsContainer)},disable:function(){this.$fileFieldContainer.find("input").prop("disabled",!0)},enable:function(){this.$fileFieldContainer.find("input").prop("disabled",!1)},addInputFile:function(a){var b=a.value.split(/\/|\\/),c=b[b.length-1],d=this.options.attachmentId++,e=this.createInputField(c,d);this._ajaxUpload(a,c,e,d)},createInputField:function(b,c){var d=this,e=a("<span>",{id:"attachments_"+c});return this.$fileFieldContainer.hide(),e.on("remove",function(){d.$fileFieldContainer.show(),d._trigger("fileremove",null,{attachmentId:c})}),e.append(a("<input>",{type:"text","class":"filename readonly",name:"attachment[filename]",readonly:"readonly"}).val(b),a("<a>&nbsp</a>").attr({href:"#","class":"remove-upload"}).click(this._removeFile).hide()).appendTo(this.$attachmentsContainer),e},successAfterUpload:function(b){var c=a("#attachments_"+b.attachmentId);c.append(a("<input>",{type:"hidden",name:"attachment[token]",value:b.token}),a("<input>",{type:"hidden",name:"attachment[content_type]",value:b.contentType})),c.find("a.remove-upload").attr({"data-remote":!0,"data-method":"delete",href:b.deletePath}).css("display","inline-block").off("click"),this._trigger("afterupload",null,b)},errorAfterUpload:function(a){this._trigger("error",null,a)},_ajaxUpload:function(b,c,d,e){var f=this,g=a(b).clone().val("");g.prependTo(this.$fileFieldContainer);var h=a("<div>").insertAfter(d.find("input.filename"));h.progressbar(),d.addClass("ajax-waiting"),a("<form>").append(b).ajaxSubmit({type:"POST",url:f.options.uploadPath,data:{filename:c,attachment_id:e,uploader:"#"+f.element.attr("id")},dataType:"script",delegation:!0,beforeSend:function(a){a.setRequestHeader("Accept","application/js")},uploadProgress:function(a,b,c,d){h.progressbar("value",d)},beforeSubmit:function(){d.removeClass("ajax-waiting").addClass("ajax-loading"),a("input:submit",d.parents("form")).prop("disabled",!0)},success:function(){h.progressbar("value",100).remove()},error:function(a,b){h.text(b)},complete:function(){d.removeClass("ajax-loading"),a("input:submit",d.parents("form")).prop("disabled",!1),a(b).parent().remove()}})},_removeFile:function(b){b.preventDefault(),a(b.target).parent("span").remove()},_random:function(){return Math.floor(99999*Math.random())}})});
/* local_avatars.js; v20140202 https://github.com/thorin/redmine_local_avatars - license: GPL v2 */
jQuery(function(a){"use strict";function e(b){0==a("#errorExplanation").length&&a("<div>").attr({id:"errorExplanation"}).prependTo("#avatar-form"),a("#errorExplanation").text(b)}function f(){d.uploader("enable"),b.photographer("enable"),a(".crop-avatar, .capture-avatar").hide(),a(".blank-avatar").show()}function g(){d.uploader("disable"),a(".crop-avatar, .blank-avatar").hide(),a(".capture-avatar").show()}function h(e,f){b.photographer("disable"),d.uploader("disable"),f?(a(".blank-avatar, .capture-avatar").hide(),a(".crop-avatar").show(),c.cropper("start",e)):(a(".crop-avatar, .capture-avatar").hide(),a(".blank-avatar").show())}var b=a(".capture-avatar"),c=a(".crop-avatar"),d=a(".add_attachment");a("#delete-avatar").bind("ajax:success",function(){location.reload()}),c.cropper(c.data()),d.uploader(d.data()).bind("uploaderafterupload",function(a,b){h(b.attachmentPath,d.data("crop"))}).bind("uploaderfileremove",function(){f(),c.cropper("stop")}),b.photographer(a.extend({},b.data(),{postData:{filename:b.data("filename"),attachment_id:"capture",authenticity_token:a("input[name=authenticity_token]").val(),uploader:"#"+d.attr("id")}})).bind("photographererror",function(a,b){e(b.message)}).bind("photographerbeforestart",g).bind("photographerbeforestop",f).bind("photographerbeforeupload",function(){d.uploader("createInputField",a(this).data("filename"),"capture")}).bind("photographerafterupload",function(b,c){a.globalEval(c.text.replace(/<\/?textarea>|/g,""))}),a.rails.href=function(a){var b=a.attr("href");return b?b:a.data("url")},a(document).delegate("input[type=button][data-remote]","click.rails",function(b){var c=a(this);return a.rails.allowAction(c)?(a.rails.handleRemote(c),!1):a.rails.stopEverything(b)})});